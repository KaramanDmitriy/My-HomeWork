"use strict";var modalHTML,favModalHTML,API_KEY="9266439c";function serchMovie(e,n,a){var o,r;return regeneratorRuntime.async(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,regeneratorRuntime.awrap(fetch("https://www.omdbapi.com/?apikey=".concat(API_KEY,"&s=").concat(e,"&type=").concat(n,"&y=").concat(a)));case 2:return o=t.sent,t.next=5,regeneratorRuntime.awrap(o.json());case 5:if("False"===(r=t.sent).Response)return alert(r.Error),t.abrupt("return");t.next=9;break;case 9:showMoviesList(r.Search);case 10:case"end":return t.stop()}})}function fetchMovieDetails(e){var n,a;return regeneratorRuntime.async(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,regeneratorRuntime.awrap(fetch("https://www.omdbapi.com/?apikey=".concat(API_KEY,"&i=").concat(e,"&plot=full")));case 2:return n=t.sent,t.next=5,regeneratorRuntime.awrap(n.json());case 5:return a=t.sent,t.abrupt("return",a);case 7:case"end":return t.stop()}})}function showMoviesList(n){var a=document.getElementById("movies-list");a.innerHTML="",n.forEach(function(t){var e=isFavorite(t.imdbID),n=document.createElement("div");n.classList.add("col-md-12","mb-4"),n.innerHTML='\n            <div class="card">\n                <img src="'.concat("N/A"!==t.Poster?t.Poster:"assets/images/reklama.jpg",'" class="card-img-top" alt="').concat(t.Title,'">\n                <div class="card-body">\n                    <h5 class="card-title">').concat(t.Title,'</h5>\n                    <p class="card-text">Year: ').concat(t.Year,'</p>\n                    <button class="btn btn-primary details-btn" data-imdbid="').concat(t.imdbID,'">Details</button>\n                    <button class="btn favorite-btn" data-imdbid="').concat(t.imdbID,'" title="Додати до улюблених" style="font-size:1.5rem;color:').concat(e?"#dc3545":"#aaa",';">\n                        <span>').concat(e?"&#10084;":"&#9825;","</span>\n                    </button>\n                </div>\n            </div>\n        "),a.appendChild(n)}),document.querySelectorAll(".details-btn").forEach(function(t){t.addEventListener("click",function(){var e,n;return regeneratorRuntime.async(function(t){for(;;)switch(t.prev=t.next){case 0:return e=this.getAttribute("data-imdbid"),t.next=3,regeneratorRuntime.awrap(fetchMovieDetails(e));case 3:n=t.sent,document.getElementById("modal-title").textContent=n.Title,document.getElementById("modal-body").innerHTML='\n                <img src="'.concat("N/A"!==n.Poster?n.Poster:"assets/images/reklama.jpg",'" class="img-fluid mb-2" alt="').concat(n.Title,'">\n                <p><strong>Year:</strong> ').concat(n.Year,"</p>\n                <p><strong>Genre:</strong> ").concat(n.Genre,"</p>\n                <p><strong>Director:</strong> ").concat(n.Director,"</p>\n                <p><strong>Actors:</strong> ").concat(n.Actors,"</p>\n                <p><strong>Plot:</strong> ").concat(n.Plot,"</p>\n                <p><strong>IMDB Rating:</strong> ").concat(n.imdbRating,'</p>\n                <div class="progress" role="progressbar" aria-label="').concat(7<=n.imdbRating?"Success":4<=n.imdbRating?"Warning":"Danger",' example" aria-valuenow="').concat(10*n.imdbRating,'" aria-valuemin="0" aria-valuemax="100">\n                    <div class="progress-bar text-bg-').concat(7<=n.imdbRating?"success":4<=n.imdbRating?"warning":"danger",'" style="width: ').concat(10*n.imdbRating,'%"></div>\n                </div>\n            '),new bootstrap.Modal(document.getElementById("movie-modal")).show();case 8:case"end":return t.stop()}},null,this)})}),document.querySelectorAll(".favorite-btn").forEach(function(t){t.addEventListener("click",function(t){t.stopPropagation();var e=this.getAttribute("data-imdbid");toggleFavorite(n.find(function(t){return t.imdbID===e})),showMoviesList(n)})})}document.getElementById("movie-modal")||(modalHTML='\n    <div class="modal fade" id="movie-modal" tabindex="-1" aria-hidden="true">\n      <div class="modal-dialog">\n        <div class="modal-content">\n          <div class="modal-header">\n            <h5 class="modal-title" id="modal-title"></h5>\n            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>\n          </div>\n          <div class="modal-body" id="modal-body"></div>\n        </div>\n      </div>\n    </div>',document.body.insertAdjacentHTML("beforeend",modalHTML)),document.getElementById("favorites-modal")||(favModalHTML='\n    <div class="modal fade" id="favorites-modal" tabindex="-1" aria-hidden="true">\n      <div class="modal-dialog modal-lg">\n        <div class="modal-content">\n          <div class="modal-header">\n            <h5 class="modal-title">Улюблені фільми</h5>\n            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>\n          </div>\n          <div class="modal-body" id="favorites-list"></div>\n        </div>\n      </div>\n    </div>',document.body.insertAdjacentHTML("beforeend",favModalHTML)),document.getElementById("favorites-btn").addEventListener("click",function(){var t=getFavorites(),e=document.getElementById("favorites-list");0===t.length?e.innerHTML="<p>Улюблених фільмів поки немає.</p>":e.innerHTML=t.map(function(t){return'\n            <div class="d-flex align-items-center mb-3">\n                <img src="'.concat("N/A"!==t.Poster?t.Poster:"assets/images/reklama.jpg",'" alt="').concat(t.Title,'" style="width:60px;height:90px;object-fit:cover;margin-right:15px;">\n                <div>\n                    <h6>').concat(t.Title," (").concat(t.Year,')</h6>\n                    <button class="btn btn-sm btn-primary fav-details-btn" data-imdbid="').concat(t.imdbID,'">Details</button>\n                    <button class="btn btn-sm remove-fav-btn" data-imdbid="').concat(t.imdbID,'" title="Видалити з улюблених" style="color:#dc3545;font-size:1.2rem;">&#10084;</button>\n                </div>\n            </div>\n        ')}).join("");var n=document.getElementById("favorites-modal");(bootstrap.Modal.getInstance(n)||new bootstrap.Modal(n)).show(),document.querySelectorAll(".fav-details-btn").forEach(function(t){t.addEventListener("click",function(){var e,n,a,o;return regeneratorRuntime.async(function(t){for(;;)switch(t.prev=t.next){case 0:return e=this.getAttribute("data-imdbid"),t.next=3,regeneratorRuntime.awrap(fetchMovieDetails(e));case 3:n=t.sent,document.getElementById("modal-title").textContent=n.Title,document.getElementById("modal-body").innerHTML='\n                <img src="'.concat("N/A"!==n.Poster?n.Poster:"assets/images/reklama.jpg",'" class="img-fluid mb-2" alt="').concat(n.Title,'">\n                <p><strong>Year:</strong> ').concat(n.Year,"</p>\n                <p><strong>Genre:</strong> ").concat(n.Genre,"</p>\n                <p><strong>Director:</strong> ").concat(n.Director,"</p>\n                <p><strong>Actors:</strong> ").concat(n.Actors,"</p>\n                <p><strong>Plot:</strong> ").concat(n.Plot,"</p>\n                <p><strong>IMDB Rating:</strong> ").concat(n.imdbRating,'</p>\n                <div class="progress" role="progressbar" aria-label="').concat(7<=n.imdbRating?"Success":4<=n.imdbRating?"Warning":"Danger",' example" aria-valuenow="').concat(10*n.imdbRating,'" aria-valuemin="0" aria-valuemax="100">\n                    <div class="progress-bar text-bg-').concat(7<=n.imdbRating?"success":4<=n.imdbRating?"warning":"danger",'" style="width: ').concat(10*n.imdbRating,'%"></div>\n                </div>\n            '),a=document.getElementById("favorites-modal"),(o=bootstrap.Modal.getInstance(a))&&o.hide(),new bootstrap.Modal(document.getElementById("movie-modal")).show();case 11:case"end":return t.stop()}},null,this)})}),document.querySelectorAll(".remove-fav-btn").forEach(function(t){t.addEventListener("click",function(){var e=this.getAttribute("data-imdbid");setFavorites(getFavorites().filter(function(t){return t.imdbID!==e})),document.getElementById("favorites-btn").click()})})});var form=document.getElementById("search-form");function getFavorites(){return JSON.parse(localStorage.getItem("favorites")||"[]")}function setFavorites(t){localStorage.setItem("favorites",JSON.stringify(t))}function isFavorite(e){return getFavorites().some(function(t){return t.imdbID===e})}function toggleFavorite(e){var t=getFavorites();isFavorite(e.imdbID)?t=t.filter(function(t){return t.imdbID!==e.imdbID}):t.push(e),setFavorites(t)}form.addEventListener("submit",function(t){t.preventDefault();var e=document.getElementById("search-input").value.trim(),n=document.getElementById("type").value,a=document.getElementById("year").value.trim();""!==e&&serchMovie(e,n,a)}),document.getElementById("year").setAttribute("max",(new Date).getFullYear());